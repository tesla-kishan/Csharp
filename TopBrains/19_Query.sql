create database Query;
use Query;


CREATE TABLE ZIPCODE_INFO (
    ZIP_CODE VARCHAR(5),
    CITY VARCHAR(25),
    STATE VARCHAR(2)
);

CREATE TABLE COURSE_INFO (
    COURSE_NO INT,
    COURSE_NAME VARCHAR(50),
    COURSE_PREREQUISITE INT NULL,
    COST INT
);

CREATE TABLE STUDENT_INFO (
    STUDENT_ID INT,
    STUDENT_FIRST_NAME VARCHAR(25),
    STUDENT_LAST_NAME VARCHAR(25),
    STREET_ADDRESS VARCHAR(50),
    ZIP_CODE VARCHAR(5)
);

CREATE TABLE INSTRUCTOR_INFO (
    INSTRUCTOR_ID INT,
    INSTRUCTOR_FIRST_NAME VARCHAR(25),
    INSTRUCTOR_LAST_NAME VARCHAR(25),
    ZIP_CODE VARCHAR(5)
);

CREATE TABLE SECTION_INFO (
    SECTION_ID INT,
    COURSE_NO INT,
    INSTRUCTOR_ID INT
);

CREATE TABLE ENROLLMENT_INFO (
    STUDENT_ID INT,
    SECTION_ID INT,
    ENROLLMENT_DATE DATE
);

CREATE TABLE GRADE_INFO (
    STUDENT_ID INT,
    SECTION_ID INT,
    GRADE_TYPE_CODE CHAR(2),
    NUMERIC_GRADE INT
);




-- ZIPCODE_INFO
INSERT INTO ZIPCODE_INFO VALUES
('10025','New York','NY'),
('10048','New York','NY'),
('11102','Astoria','NY'),
('11209','Brooklyn','NY'),
('07001','Edison','NJ'),
('48001','Detroit','MI');

-- COURSE_INFO
INSERT INTO COURSE_INFO VALUES
(10,'Intro to SQL',NULL,4000),
(20,'Intro to Java',10,4500),
(25,'Advanced SQL',20,7000),
(30,'Intro to Python',NULL,3500),
(40,'Data Science',25,2000);

-- STUDENT_INFO
INSERT INTO STUDENT_INFO VALUES
(301,'Ravi','Sharma','Street A','10025'),
(320,'Amit','Graham','Street B','10048'),
(340,'Neha','Singh','Street C','11102'),
(360,'Pooja','Graham','Street D','11209');

-- INSTRUCTOR_INFO
INSERT INTO INSTRUCTOR_INFO VALUES
(1,'John','Schumer','10025'),
(2,'Alice','Miller','07001'),
(3,'David','Smith','10025');

-- SECTION_INFO
INSERT INTO SECTION_INFO VALUES
(1,10,1),
(2,20,2),
(3,25,3);

-- ENROLLMENT_INFO
INSERT INTO ENROLLMENT_INFO VALUES
(301,1,'1999-01-10'),
(320,2,'1999-01-15'),
(340,3,'2000-02-10');

-- GRADE_INFO
INSERT INTO GRADE_INFO VALUES
(301,1,'FI',80),
(320,2,'MI',70),
(340,3,'FI',90);



-- PLAIN SELECT QUERIES
------------------------------------------------
EXEC sp_help COURSE_INFO;

SELECT ZIP_CODE, CITY, STATE AS StateName FROM ZIPCODE_INFO;

SELECT DISTINCT STATE FROM ZIPCODE_INFO;

SELECT STUDENT_ID,
       STUDENT_FIRST_NAME + ' ' + STUDENT_LAST_NAME AS StudentName
FROM STUDENT_INFO;

SELECT ZIP_CODE + ', ' + CITY + ', ' + STATE AS Address
FROM ZIPCODE_INFO;

SELECT COURSE_NAME FROM COURSE_INFO;

SELECT COURSE_NAME, COST FROM COURSE_INFO;

SELECT * FROM COURSE_INFO;

SELECT INSTRUCTOR_LAST_NAME, ZIP_CODE FROM INSTRUCTOR_INFO;

SELECT DISTINCT ZIP_CODE FROM STUDENT_INFO;

SELECT STUDENT_FIRST_NAME, STUDENT_LAST_NAME FROM STUDENT_INFO;

SELECT CITY, STATE, ZIP_CODE FROM ZIPCODE_INFO;


------------------------------------------------
-- SELECT WITH WHERE
------------------------------------------------
SELECT STUDENT_ID, SECTION_ID, NUMERIC_GRADE
FROM GRADE_INFO
WHERE GRADE_TYPE_CODE = 'FI';

SELECT ZIP_CODE, CITY
FROM ZIPCODE_INFO
WHERE STATE = 'MI';

SELECT s.STUDENT_FIRST_NAME + ' ' + s.STUDENT_LAST_NAME AS StudentName
FROM STUDENT_INFO s
JOIN ENROLLMENT_INFO e ON s.STUDENT_ID = e.STUDENT_ID
WHERE MONTH(e.ENROLLMENT_DATE) = 1
  AND YEAR(e.ENROLLMENT_DATE) = 1999
ORDER BY StudentName;

SELECT SECTION_ID, INSTRUCTOR_ID
FROM SECTION_INFO
WHERE COURSE_NO IN (10,20)
ORDER BY INSTRUCTOR_ID;

SELECT STUDENT_ID, SECTION_ID, NUMERIC_GRADE
FROM GRADE_INFO
ORDER BY SECTION_ID ASC, NUMERIC_GRADE DESC;

SELECT COURSE_NO, COURSE_NAME, COST
FROM COURSE_INFO
WHERE COURSE_NAME LIKE '%Intro%';

SELECT * FROM COURSE_INFO
WHERE COURSE_NAME LIKE '%a__';

SELECT * FROM STUDENT_INFO
WHERE STUDENT_ID BETWEEN 300 AND 350;

SELECT * FROM COURSE_INFO
WHERE COST BETWEEN 4000 AND 7000;

SELECT INSTRUCTOR_FIRST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME = 'Schumer';

SELECT INSTRUCTOR_FIRST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME <> 'Schumer';

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST > 4000;

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST BETWEEN 3000 AND 7000;

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST IN (4000,4500);

SELECT STUDENT_FIRST_NAME, STREET_ADDRESS
FROM STUDENT_INFO
WHERE STUDENT_LAST_NAME LIKE 'S%';

SELECT STUDENT_FIRST_NAME, STREET_ADDRESS
FROM STUDENT_INFO
WHERE STUDENT_LAST_NAME LIKE '_o%';

SELECT INSTRUCTOR_FIRST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME NOT LIKE 'S%';

SELECT COURSE_NAME, COST
FROM COURSE_INFO
WHERE COST BETWEEN 4000 AND 4500
AND COURSE_NAME LIKE 'I%';

SELECT COURSE_NAME, COST, COURSE_PREREQUISITE
FROM COURSE_INFO
WHERE (COST = 2000 AND COURSE_PREREQUISITE = 20)
   OR COURSE_PREREQUISITE = 25;

SELECT COURSE_NAME, COST, COURSE_PREREQUISITE
FROM COURSE_INFO
WHERE COST = 2000
   OR COURSE_PREREQUISITE IN (20,25);

SELECT * FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL;

SELECT STUDENT_LAST_NAME
FROM STUDENT_INFO
WHERE ZIP_CODE IN ('10048','11102','11209');

SELECT INSTRUCTOR_FIRST_NAME, INSTRUCTOR_LAST_NAME
FROM INSTRUCTOR_INFO
WHERE INSTRUCTOR_LAST_NAME LIKE '%i%'
AND ZIP_CODE = '10025';

SELECT COURSE_NAME
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NOT NULL
AND COST < 1100;

SELECT DISTINCT COST
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL;

SELECT COURSE_NO, COURSE_NAME
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL
ORDER BY COURSE_NAME;

SELECT COURSE_NO, COURSE_NAME
FROM COURSE_INFO
WHERE COURSE_PREREQUISITE IS NULL
ORDER BY COURSE_NAME DESC;

SELECT CITY, STATE, ZIP_CODE
FROM ZIPCODE_INFO
WHERE STATE IN ('NY','CT')
ORDER BY ZIP_CODE;

SELECT ZIP_CODE, STUDENT_FIRST_NAME, STUDENT_LAST_NAME
FROM STUDENT_INFO
WHERE STUDENT_LAST_NAME = 'Graham'
ORDER BY ZIP_CODE DESC, STUDENT_FIRST_NAME ASC;

SELECT CITY + ', ' + STATE AS CityState
FROM ZIPCODE_INFO;

SELECT UPPER(LEFT(STUDENT_FIRST_NAME,1)) +
       LOWER(SUBSTRING(STUDENT_FIRST_NAME,2,LEN(STUDENT_FIRST_NAME)))
FROM STUDENT_INFO;

SELECT INSTRUCTOR_FIRST_NAME + ', ' + INSTRUCTOR_LAST_NAME
FROM INSTRUCTOR_INFO;

SELECT COST,
       COST + 10,
       COST - 20,
       COST * 30,
       COST / 5
FROM COURSE_INFO;

SELECT DISTINCT NUMERIC_GRADE,
       NUMERIC_GRADE / 2
FROM GRADE_INFO;